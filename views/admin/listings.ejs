
<%- include("../includes/adminHeader.ejs")%>
    <%-include("../includes/flash.ejs")%>
<div class="container mt-5">
  <h2 class="mb-4 text-center fw-bold">All Listings</h2>

  <% if (listings.length === 0) { %>
    <div class="alert alert-info text-center">No listings found.</div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle text-center shadow-sm">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Title</th>
            <th>Location</th>
            <th>Country</th>
            <th>Price (₹)</th>
            <th>Owner</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% listings.forEach((listing, index) => { %>
            <tr>
              <td><%= index + 1 %></td>
              <td><%= listing.title %></td>
              <td><%= listing.location %></td>
              <td><%= listing.country %></td>
              <td>₹ <%= listing.price ? listing.price.toFixed(2) : "0.00" %></td>
              <td>
                <% if (listing.owner) { %>
                  <%= listing.owner.username %> <br>
                  <small class="text-muted"><%= listing.owner.email %></small>
                <% } else { %>
                  <em class="text-danger">No owner</em>
                <% } %>
              </td>
              <td>
                <a href="/listings/<%= listing._id %>" class="btn btn-sm btn-primary">
                  <i class="fa fa-eye"></i> View
                </a>
                <form
                  action="/listings/<%= listing._id %>?_method=DELETE"
                  method="POST"
                  class="d-inline"
                  onsubmit="return confirm('Are you sure you want to delete this listing?');"
                >
                  <button type="submit" class="btn btn-sm btn-danger">
                    <i class="fa fa-trash"></i> Delete
                  </button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>

