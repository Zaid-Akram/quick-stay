<% layout("layout/hostLayout") %>

<h3>Welcome, <%= currentUser.username %> ðŸ‘‹</h3>
<h5 class="mt-3">Notifications</h5>
<ul class="list-group mb-4">
  <% if (!host.notifications || host.notifications.length === 0) { %>
    <li class="list-group-item">No new notifications.</li>
  <% } else { %>
    <% host.notifications.slice().reverse().forEach(note => { %>
      <li class="list-group-item">
        <%= note.message %>
        <small class="text-muted d-block"><%= new Date(note.createdAt).toLocaleString() %></small>
      </li>
    <% }) %>
  <% } %>
</ul>
<p class="text-muted">Manage your listings below:</p>

<div class="row mt-3">
  <% if (myListings.length === 0) { %>
    <p>You havenâ€™t added any listings yet. <a href="/listings/new">Add one now!</a></p>
  <% } else { %>
    <% myListings.forEach(listing => { %>
      <div class="col-md-4 mb-3">
        <div class="card shadow-sm">
          <img src="<%= listing.image.url %>" class="card-img-top" style="height:200px; object-fit:cover;">
          <div class="card-body">
            <h5 class="card-title"><%= listing.title %></h5>
            <p class="text-muted"><%= listing.location %></p>
            <div class="d-flex justify-content-between">
              <a href="/listings/<%= listing._id %>" class="btn btn-primary btn-sm">View</a>
              <a href="/listings/<%= listing._id %>/edit" class="btn btn-warning btn-sm">Edit</a>
              <!-- <form method="POST" action="/listings/<%= listing._id %>?_method=DELETE">
                <button class="btn btn-danger btn-sm">Delete</button>
              </form> -->
            </div>
          </div>
        </div>
      </div>
    <% }) %>
  <% } %>
</div>
